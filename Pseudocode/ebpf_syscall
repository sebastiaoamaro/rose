#imports

//ALL METRICS WHICH WILL BE USED FOR FAULT INJECTION
HASHMAP_IMPORTANT_STATE_INFO, key - property ex:bytessent, value - array of values[]

//TRACING
MAP_SYSCALL_INFO key-ts?, info

//To signal controller that condition is met
PROPERTY_SIGNALING, key property, Boolean

//Start overriding return in this syscall
INJECT_FAULT_MAP, key syscall, Boolean


//COUNTERS SUCH AS COUNTING BYTES RECEIVED
LOCAL_STATE_COUNTERS

int hook(struct state){

    struct collect_state = state.info;

    mapa_syscall_info.add(state.info.ts, stateinfo);

    COUNTERS.increment(state.info.size);

    COUNTERS.increment(state.info.***);

    ...

    struct relevant_state = COUNTERS & state.info;

    //ex:bytes received
    u32[] important_property = HASHMAP_IMPORTANT_STATE_INFO.get(property);

    if (important_property != NULL){
        for value in important_property{
            if value == bytes_received{
                PROPERTY_SIGNALING.change(key_property,true);
            }
        }
    }

    if INJECT_FAULT_MAP.get(this_syscall){
        bpf_override_return();
    }




}